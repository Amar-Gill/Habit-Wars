{% extends '_layout.html' %}


{% block title %}
Your proDUCKtive war
{% endblock %}

{% block content %}

<div class="container justify-content-center">

    <!-- check if game accepted -->
    {% if not game_accepted %}

        <!-- check if user is p1 or p2 -->
        {% if active_user == 2 %}
            <h1> BLAH has challenged you to a Habit War! Click the button to accept =]</h1>
            <form>
                <button>LITLIT</button>
            </form>
        {% else %}
            <h1 id='waiting-header'>Waiting for Player 2 to accept your challenge!</h1>
            <img id="shuriken" align="middle" src="/static/img/ninja-shuriken.png"/>
            <div id="attribution-tag">Icons made by <a href="https://www.flaticon.com/authors/freepik" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div>
        {% endif %}

    {% else %}

    <!-- Page state when game is accepted -->
    <h1>Your proDUCKtivity war</h1>

    <!-- Active User Habits -->
    <div id="container" class="d-flex justify-content-between">
        <div class="col-5" id="p1-habits">
            <img class="w-100" src="/static/img/game-duck-2.jpg">
            <h3>Your habits</h3>
            {% for i in range(0, length_habit_list)|reverse %}
            <div class="habit">
                <p>{{user_habits[i].name}}! {{user_more_to_go[i]}} more to go!</p>
                <div class="progress">
                    <div class="progress-bar" role="progressbar" aria-valuenow="{{rounded_progress[i]}}"
                        aria-valuemin="0" aria-valuemax="100" style="width: {{rounded_progress[i]}}%">
                    </div>
                </div>
                <form action={{ url_for('log_habits.create')}} method="POST" enctype="multipart/form-data">
                    <input name='image-for-{{user_habits[i].id}}' type="file" accept="image/*" capture="camera" value="Add photo">
                    <input name='habit-id' type='hidden' value={{user_habits[i].id}}>
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <input type="submit" value="Habit done">
                </form>

            </div>
            {% endfor %}
        </div>



        <!-- Opponent habits -->

        <div class="col-5" id="p1-habits">
            <img class="w-100" src="/static/img/game-duck-1.jpg">
            <h3>{{opponent_username}}'s habits</h3>
            {% for i in range(0, opponent_habit_length)|reverse %}
            <div class="habit">
                <p>{{opponent_habits[i].name}}</p>
                <div class="progress">
                    <div class="progress-bar testbar" role="progressbar" aria-valuenow="{{rounded_opponent_progress}}" aria-valuemin="0"
                        aria-valuemax="100" style="width: {{rounded_opponent_progress[i]}}%">
                        <span class="sr-only">73% Complete</span>
                    </div>
                </div>

            </div>
            {% endfor %}
        </div>
    </div>

    <div id='game_history'>
        <h2>Battle history</h2>
    </div>

    {% endif %}

</div>

<style>

#waiting-header {
    margin-bottom: 16vh;
}

#shuriken {
    width: 64vw;
    margin: auto;
    display: block;
    
    animation-name: spinning;
    animation-duration: 2.5s;
    animation-iteration-count: infinite;
    animation-timing-function: linear;
    }

#attribution-tag {
    bottom: 2vh;
    position: absolute;
}

@keyframes spinning {

    100% { transform: rotate(360deg);}

}

</style>

{% endblock %}